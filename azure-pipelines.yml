pool:
  vmImage: 'ubuntu-16.04'

trigger: none

steps:
- checkout: self
  clean: true
  persistCredentials: true

- script: |
    git config --global user.email "$(github_email)"
    git config --global user.name "$(github_user)"
  displayName: 'Configure global git user'

- script: |
    ls -alrt ./h2h/standings
    cat ./h2h/standings/q1.json
  displayName: 'Echo Q1 JSON file'

- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.6'
  displayName: 'Set Python version'

- script: |
    python -m pip install --upgrade pip requests
  displayName: 'Install Python packages'

- task: PythonScript@0
  inputs:
    scriptSource: 'filePath'
    scriptPath: 'generate_h2h_standings.py'
  displayName: 'Run generate_h2h_standings.py'
  
  env:
    FPL_USERNAME: $(fpl_username)
    FPL_PASSWORD: $(fpl_password)
    FPL_LEAGUE_ID: $(fpl_league_id)

- script: |
    git status
  displayName: 'Echo git status'

- script: |
    ls -alrt ./h2h/standings
    cat ./h2h/standings/q1.json
  displayName: 'Echo Q1 JSON file'